<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="stylesheet" href="./css/style.css">
  <title>chat</title>
</head>
<body>

  <form>
    <fieldset>
      <legend>チャット入力画面</legend>
      <div>name: <input type="text" id="name" /></div>
      <div>text: <input type="text" id="text" /></div>
      <div>
        <button type="button" id="send">send</button>
      </div>
    </fieldset>
  </form>


  <!-- jquery読み込み -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

  <script>
    // 日時をいい感じの形式にする関数(Timestamp);
    function convertFromFirestoreTimestampToDatetime(timestamp) {
      const _d = timestamp ? new Date(timestamp * 1000) : new Date();
      const Y = _d.getFullYear();
      const m = (_d.getMonth() + 1).toString().padStart(2, '0');
      const d = _d.getDate().toString().padStart(2, '0');
      const H = _d.getHours().toString().padStart(2, '0');
      const i = _d.getMinutes().toString().padStart(2, '0');
      const s = _d.getSeconds().toString().padStart(2, '0');
      return `${Y}/${m}/${d} ${H}:${i}:${s}`;
    }
  </script>


  <!-- firebaseのいろいろ読み込み -->
  <script type ="module">
  
  //Firebaceを利用するためのコード
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.2.0/firebase-app.js";
  
  //Firebaceの関数を利用するためのコード
  import {
    getFirestore,
    collection,
    addDoc,
    serverTimestamp,
    onSnapshot,
    query,
    orderBy,
  } from "https://www.gstatic.com/firebasejs/9.2.0/firebase-firestore.js";

//自分のプロダクトを特定するためのコード
  const firebaseConfig = {
      
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    $('#send').on('click', function () {//sendボタンが押されたら
        console.log('click');//コンソールにクリックと表示
        const data = {//データ送信用の変数
          name: $("#name").val(),//name欄に入力されたもの
          text: $("#text").val(),//text欄に入力されたもの
          time: serverTimestamp(),//現在時間
        };
        addDoc(collection(db, "chat"), data);//Firebaseのchatコレクションにデータを送る
        $("#text").val("");//text欄は空欄に
      });


  </script>

  <!-- <script type ="module" src="./js.main.js"></script> -->
  
  
  

</body>
</html>